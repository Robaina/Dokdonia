
MAPPING
I had some problems to get fragment counts with the DokdoniaMED134 data set.
Here are my conclusions:
1. The GTF file must contain the same identifier (in the first column) than the
   one used in the FASTA file (it is meant to be the chromosome name, but any
   id will do, like DokdoniaMED134)
2. You can safely change "exon" by "gene" in the GTF (more accurate for bacteria)
   as long as you change the corresponding parameter in featureCounts
3. There isn't any problem with the paired-end data, in fact, I obtained more
   counts when using both FASTQ files than when I only used the forward one (as
   expected)
4. Some parameters in featureCounts are key, must decided whether multimapping is
   allowed, for instance, this increases counts in over 5%.
   
 NORMALIZATION
 This paper concludes TPM (transcripts per million) is the best approach (I had the
 same idea) https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-3247-x.
 Also, in this paper, where authors introduce TPM, they talk about the inconsistencies of RPKM:
 https://link.springer.com/article/10.1007/s12064-012-0162-3.
 
 So TPM it is.
 
 DIFFERENTIAL ANALYSIS
 TPM is not good to compare among samples because it depends on the particular RNA population
 of the sample, and this may vary among samples. This paper explains it: 
 https://rnajournal.cshlp.org/content/early/2020/04/13/rna.074922.120.full.pdf
 
 In particular, they write:
 " Depending   on   severity ,  these  differenc es  can  influence  the  biological
 interpre ta tion  of  gene  expressio n  values. RPKM  and  TPM repr esent   r elative   
 abund ance   of   transcr ipts   in   a   sample   but   do   not   normalize   for   
 global   shifts   in   total  RNA cont ents (Aanes et al . 2014).
 
 SUMMARY
 A handy summary of methods depending on the objective:
 https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html
 
 Also here: https://academic.oup.com/bib/article/19/5/776/3056951
 Where authors write:
 "Hence, when there are a few genes that are highly expressed in only one of the conditions, the few genes will make up a greater share of the total molecules and so a smaller fraction of the reads will be left for the other genes [7]. This can cause the false appearance of differential expression for the non-DE genes, and normalization is needed to account for this difference"
 
 "A further need for normalization is therefore in cases of global shifts in expression, in which it is necessary to take into account the differences in overall expression between conditions."
 
 Hence, it may happen that in one condition a few genes are very highly express and this introduces
 bias in the DE of the rest of the genes, making some appear as DE across conditions when they are not.
 
 CONCLUSIONS
1. Use TPM for within-sample comparisons
2. Use DeqSeq2 for between-sample comparisons

Both require construction of counts matrix.
